# クラウドワークスのメール 自動転記ツール（GAS）
Google Apps Script（GAS）を使って、クラウドワークスから届く応募関連メールをスプレッドシートに自動転記するツールです。  
スレッドIDでの重複防止やカテゴリ分類、管理用のステータス列にも対応しており、応募管理を効率化できます。

## 主な機能
- Gmailから対象のクラウドワークスメールのみを自動抽出
- 件名に応じて「応募」「スカウト」「辞退」などのカテゴリを自動判定
- 応募日や本文も抽出し、スプレッドシートに追記
- ステータス列（F列）を手動で管理し、条件に応じて行を自動非表示


## スプレッドシートの構成
| 列 | 内容 |
|----|------|
| A列 | スレッドID（重複防止用） |
| B列 | カテゴリ（応募/スカウト/辞退 など） |
| C列 | 応募日時 |
| D列 | 件名 |
| E列 | 本文（自動フッターなど除去済） |
| F列 | ステータス（手動入力） |

## 自動カテゴリ判定のルール
| 件名に含まれる文字列 | カテゴリ |
|-----------------------|----------|
| `相談がありました` | スカウト |
| `ご応募いただきありがとうございます` | 応募 |
| `応募・スカウトが辞退されました` | 辞退 |
| 上記以外 | その他 |

## 応募データの表示制御（ステータス列）
スプレッドシートのF列に手動で記入するステータスにより、行が自動的に非表示になります。
- `-` の場合 → 非表示
- `回答待ち` かつ 1ヶ月以上前のデータ → 非表示
- その他 → 表示（何も処理しない）

## セットアップ手順
1. Google スプレッドシートを作成
2. 拡張機能 > Apps Script を開いて、本リポジトリの `	extract-emails.gs` 、 `filter-rows.gs` をコピー
3. スクリプトに Gmail、スプレッドシートの読み取り権限を付与
4. メニュー「トリガー」から `extractCrowdWorksEmails` を定期実行（1時間ごとなど）
5. F列にステータスを記入することで応募の管理が可能に
6. メニュー「トリガー」から `updateRowVisibility` を定期実行（1日ごとなど）
